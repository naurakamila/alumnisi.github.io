!function(t){var h,l,e=(h=t,(l=[{},{},{},{},{},{}])[2][1]={float:["left","left"],height:["100%","100%"],width:["50%","50%"]},l[2][2]={float:["",""],height:["50%","50%"],width:["100%","100%"]},l[2][3]={float:["left","left"],height:["50%","50%"],width:["50%","50%"]},l[3][1]={float:["left","left","left"],height:["100%","50%","50%"],width:["66.6%","33.3%","33.3%"]},l[3][2]={float:["","left","left"],height:["66.6%","33.3%","33.3%"],width:["100%","50%","50%"]},l[3][3]={float:["","left","left"],height:["50%","50%","50%"],width:["100%","50%","50%"]},l[4][1]={float:["left","left","left","left"],height:["100%","33.3%","33.3%","33.3%"],width:["66.6%","33.3%","33.3%","33.4%"]},l[4][2]={float:["","left","left","left"],height:["66.6%","33.3%","33.3%","33.3%"],width:["100%","33.3%","33.3%","33.3%"]},l[4][3]={float:["left","left","left","left"],height:["50%","50%","50%","50%"],width:["50%","50%","50%","50%"]},l[5][1]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},l[5][2]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},l[5][3]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},{update:function(){h("[data-ps-grid=photos]").not(function(){return h(this).data("ps-grid-initialized")}).each(h.proxy(function(t,e){(e=h(e)).data("ps-grid-initialized",!0),this._arrange(e)},this))},_arrange:function(i){var t,a=i.children("[data-ps-grid-item]"),n=a.find("img[src]");i.css({position:"relative",width:"100%",maxWidth:600,minWidth:200,maxHeight:1200,overflow:"hidden"}),t=_.map(h.makeArray(n),function(t){return t.src}),this._loadImages(t).always(h.proxy(function(){var t,e,o;1<a.length&&(t=h.makeArray(n),e=this._isPotrait(t)?1:this._isLandscape(t)?2:3,o=l[t.length][e],a.each(function(t){var e=h(this),i=o.width[t],a=o.height[t],t=o.float[t];e.css({float:t,width:i,paddingTop:a}),_.defer(function(t,e,i){t=t.find("img");t.hasClass("ps-js-fitted")||(t.addClass("ps-js-fitted"),e/i<(t[0].naturalWidth||t[0].width)/(t[0].naturalHeight||t[0].height)?t.css({width:"auto",height:"100%"}):t.css({width:"100%",height:"auto"}))},e,parseFloat(i),parseFloat(a))})),a.show(),i.children(".ps-js-loading").remove()},this))},_isPotrait:function(t){return t=_.isArray(t)?t:[t],.5<_.filter(t,function(t){return(t.naturalWidth||t.width)/(t.naturalHeight||t.height)<.75}).length/t.length},_isLandscape:function(t){return t=_.isArray(t)?t:[t],.5<_.filter(t,function(t){var e=t.naturalWidth||t.width;return(t.naturalHeight||t.height)/e<.75}).length/t.length},_loadImage:function(o){return h.Deferred(function(t){var e=new Image;function i(){a(),t.reject(e)}function a(){e.onload=null,e.onerror=null,e.onabort=null}e.onload=function(){a(),t.resolve(e)},e.onerror=i,e.onabort=i,e.src=o}).promise()},_loadImages:function(t){var e=[];return(t=!_.isArray(t)?[t]:t).forEach(h.proxy(function(t){e.push(this._loadImage(t))},this)),h.when.apply(h,e)}});peepso.photoGrid=function(){e.update()},t(function(){peepso.photoGrid(),t(window).on("load",function(){peepso.photoGrid()}),t(document).on(["ps_activitystream_loaded","ps_activitystream_append","peepso_post_edit_saved","peepso_repost_shown","peepso_repost_added"].join(" "),function(t){"ps_activitystream_append"===t.type?setTimeout(peepso.photoGrid,3e3):peepso.photoGrid()})})}(jQuery);